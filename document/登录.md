登录

大厅

游戏里



```js
这些都是与store.js耦合的
本地存储：
用户ｉｄ：
ｔｏｋｅｎ
//websocket各种请求,和store.js耦合，get_me_id获取我的游戏的id,自己和别人摸牌,自己选择一个选择，获取分数，倒计时，退出
／／在ｇａｍｅ．ｖｕｅ的ｃｈｅｃｋｄａｔａ函数里面写ｄａｔａ．ｔｙｐｅ，然后进ｃｏｍｍｉｔ，
／／ｓｔｏｒｅ．ｊｓ部分已经完成
获取我的游戏ｉｄ
自己摸牌＄ｓｔｏｒｅ．ｓｔａｔｅ．ｍｅ．ｐｌａｙｅｒ＿ｉｄ
别人摸牌
ｎｕｍｂｅｒ
摆放搁置的牌，在ｓｔｏｒｅ里面＄ｓｔｏｒｅ．ｓｔａｔｅ．ｍｅ．ｄｉｓｃａｒｄｅｄ＿ｃａｒｄ
获取分数　接受消息ｐｏｉｎｔｓ数组

选择，接收消息，获取选项ｏｐｔｉｏｎｓ
倒计时，不断接收消息，更新前端的倒计时数字＄ｓｔｏｒｅ．ｔｉｍｅ，未完成接受消息部分
退出游戏
//加入牌局，创建牌局

//加入大厅
ｌｏｇｉｎ．ｖｕｅ里的ｍｅｔｈｏｄｓ的ｌｏｇｉｎ和ｃｌｉｃｋ方法代表登录和注册，通过发送ｐｏｓｔ请求进行注册和登录，同源策略？
登录：根据ｌｏｃａｌｓｔｏｒａｇｅ的ｆｌａｇ是否为ｔｒｕｅ决定是否需要登录，如果为ｆａｌｓｅ，就进行一次Ｐｏｓｔ请求，如果为ｔｒｕｅ就直接
        this.$router.push("/ｈａｌｌ");
登录后自动加入大厅,在login界面发送请求
登录成功后路由跳转，存储ｔｏｋｅｎ和用户ｉｄ
接受消息获取所有牌局的列表，
可以选择点击加入一个牌局，创建一个牌局
house里join函数加入牌牌局，发送自己账号的user_id和加入牌局的number
创建牌局，在hall.vue里创建牌局
//退出登录

```

```c++
//啊，如何进行post请求????
login登录时,注册时，创建牌局时，加入牌局时
```



```js
    click(){
      //发送post请求
      this.$http.post('http://198.211.12.166:23333/register', {
        name: this.r_name,
        user_id: this.r_user_id,
        email: this.r_email,
        password: this.r_password
      }).then(()=> {
        console.log("接受数据");
        this.loginBox.style.display = "block";
        this.registerBox.style.display = "none";
        alert("注册成功");
      }).catch(
          function (error) {
            const pipei={
                "ensure this value has at most 7 characters":"昵称最多7位",
              "string does not match regex \"^[a-zA-Z\\u4e00-\\u9fa5]+$\"":"请输入昵称",
              "ensure this value has at least 5 characters":"ID至少包含5个字符",
              "value is not a valid email address":"不是正确的邮箱地址",
              "ensure this value has at least 8 characters":"密码至少八位",
              "该邮箱已存在":"该邮箱已存在"
            }
            var i=0;

              if(typeof error.response.data.detail=="string"){
                alert(error.response.data.detail);
              }else {
                while (error.response.data.detail[i]) {
                  if (pipei[error.response.data.detail[i].msg]) {
                    alert(pipei[error.response.data.detail[i].msg]);
                  } else {
                    alert(error.response.data.detail[i].loc[1]);
                    alert(error.response.data.detail[i].msg)
                  }
                  i++;
                }
                this.getElementById("r_error").display = "block";

              }
          });
    }
```

```js
    login(){
      //当地存储没有flag的时候要去拿存储或者登录用户与已登录用户不匹配时去拿数据
      if(window.localStorage.getItem("flag")!=="true") {
        this.axios.post('http://198.211.12.166:23333/login',
            {
          user_id: this.user_id,
          password: this.password
        },
            {
              headers:{
                "Access-Control-Allow-Origin":"*"
              }
            }).then(()=> {
              // eslint-disable-next-line no-undef
              window.localStorage.setItem('hall',true)
                this.$router.push("/hall");
                alert(1);
              }
            ).catch(
            function (error) {
              window.localStorage.setItem('hall',true)
              


              // const pipei={
              //   "field required":"需要输入"
              // }
              alert(error);
            //   if(error!==null){
            //   var i=0;
            //   while (error.response.data.detail[i]) {
            //     if (pipei[error.response.data.detail[i].msg]) {
            //       alert(pipei[error.response.data.detail[i].msg]);
            //     } else {
            //       alert(error.response.data.detail[i].loc[1]);
            //       alert(error.response.data.detail[i].msg)
            //     }
            //     i++;
            //   }
            // }else{
            //     console.log("成功");
            //     this.$router.push("/game");
            //   }
            }
        );
      }else{
        window.localStorage.setItem('hall',true);
        this.$router.push("/hall");
      }


    },
```

```js
//路由守护???为什么我进不去大厅?
```

```js
获取token，登录时
```



```js
前后端对接
token部分登录时候，储存token
登出需要
牌桌列表
创建牌桌
加入牌桌
```

![image-20230407172059946](D:\AppData\Typora\typora-user-images\image-20230407172059946.png)

![image-20230407172110650](D:\AppData\Typora\typora-user-images\image-20230407172110650.png)

![image-20230407172121076](D:\AppData\Typora\typora-user-images\image-20230407172121076.png)

![image-20230407172039600](D:\AppData\Typora\typora-user-images\image-20230407172039600.png)

## 登录

### login

本地存储：
用户ｉｄ：user_id
ｔｏｋｅｎ

![image-20230407180951215](D:\AppData\Typora\typora-user-images\image-20230407180951215.png)

![image-20230407181512617](D:\AppData\Typora\typora-user-images\image-20230407181512617.png)

这段代码位置不对，应该在返回数据判断后再跳转

### register

![image-20230407181022153](D:\AppData\Typora\typora-user-images\image-20230407181022153.png)

## 大厅:

### 退出hall.vue

![image-20230407182832635](D:\AppData\Typora\typora-user-images\image-20230407182832635.png)

### 创建牌桌 hall.vue

![image-20230407175243062](D:\AppData\Typora\typora-user-images\image-20230407175243062.png)

![image-20230407175519884](D:\AppData\Typora\typora-user-images\image-20230407175519884.png)

![image-20230407180249461](D:\AppData\Typora\typora-user-images\image-20230407180249461.png)

这个位置有点问题，应该在数据发过来判断后再决定是否跳转

### 加入牌桌house.vue

![image-20230407175920750](D:\AppData\Typora\typora-user-images\image-20230407175920750.png)

点击后把table_code牌桌号发过去

![image-20230407180011947](D:\AppData\Typora\typora-user-images\image-20230407180011947.png)

![image-20230407180136578](D:\AppData\Typora\typora-user-images\image-20230407180136578.png)

这个位置有点问题，应该在结果发过来判断后再跳转

### 刷新hall.vue

![image-20230407174038918](D:\AppData\Typora\typora-user-images\image-20230407174038918.png)

![image-20230407174316106](D:\AppData\Typora\typora-user-images\image-20230407174316106.png)

重新发送hall的post请求✓

将返回的数据存入store.js✓

然后会自动解析，展示出来



完成前端展示

![image-20230407173014231](D:\AppData\Typora\typora-user-images\image-20230407173014231.png)





## 游戏内

### 创建/加入游戏后应该等待

一切默认为空，并且有一个灰框框等待其他玩家加入

## 连接websocket服务器后一系列动作改变store来改变前端展示



